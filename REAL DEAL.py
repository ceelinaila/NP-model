# -*- coding: utf-8 -*-
"""
Created on Tue Mar  7 16:44:31 2023

@author: Bruger
"""
#REAL DEAL
# -*- coding: utf-8 -*-
import numpy as np
import matplotlib
import matplotlib.pyplot as plt
from scipy.integrate import odeint
from scipy.integrate import solve_ivp


"""
Initial conditions
"""
#initial conditions
P = np.zeros(100)  #mmol N/m3
P[0] = 0.5 #mmol N/m3
N = np.full((100),30) #30 mmol N/m3 in all depths


"""
Parameters
"""
#Find parameters from article
class params:
    pass
params.dz = 1 #water column depth, m
#Light absorption
params.kw = 0.2 #1/L -> 1/m
#Shelf-shading/light attenuation, m2/mmol N
params.kp = 0.05
params.I0 = 350 #Einstein
params.n = 100
#Diffusion coefficient, m2/day
params.D = 5
#Sinking of phytoplankton m/day
params.u = 3 #vertical velocity, m/day
params.d = 100 #depth, m
#Making grid
params.z = np.arange(0.5*params.dz,1+params.d-0.5*params.dz,params.dz) #start, stop, step
params.H = 20 #Einstein
#half saturation of nutrients, mmol/m3
params.HN = 0.3
#Max growth rate, 1/day
params.gmax = 1.5
params.l = 0.01*24 #loss rate, 1/day
params.ebselon = 0.5 #dimensionless, 
params.nB = 30 #bottom boundary conditions
#Grazing mortality, m3/mmol N/day
params.gamma = 1.5
#Latitude in Greenland
params.phi = 75
t=[0,365*2]


"""
Light and growth functions
"""
#BE AWARE: to add seasonality, ad "t" to the light and growth function
def light(P,params):
    Q = params.kp * params.dz * (np.cumsum(P) + (P/2))
    #remove this I for seasonality
    I = params.I0 * np.exp(-params.kw * params.z - Q)
    #Add this I_season and I for seasonality
  #  I_season = params.I0 * (1-0.8*np.sin(np.pi*params.phi/180)*np.cos(2*np.pi*t/365))
 #   I = I_season * np.exp(-params.kw * params.z - Q)
    return I

#Outcomment this for seasonality
I = light(P,params)

def growth(N,P,t,params):
    
    g = params.gmax * np.minimum((light(P,params)/(light(P,params) + params.H)), N/(N + params.HN))

    return g
#g = growth(N,P,t,params)

"""
Phytoplankton concentration
"""
#Both diffusion and advection
def fluxP(t,P,N,params):
    Ja = np.zeros(params.n+1)
    Jd = np.zeros(params.n+1)
    J = np.zeros(params.n+1)
    dphidt = np.zeros(params.n)
    for i in range(params.n+1):
        if i == 0 or i == params.n:
            Ja[0] = 0
            Jd[0] = 0
            Ja[params.n] = 0
            Jd[params.n] = 0
        else:
            Ja[i] = params.u * P[i-1]
            Jd[i] = -params.D * (P[i]-P[i-1])/params.dz        
        J[i] = Ja[i] + Jd[i]
    for i in range(params.n):
        dphidt[i] = -(J[i+1] - J[i])/params.dz
        dPdt =  growth(N,P,t,params) * P - params.l * P - params.gamma * P**2 + dphidt
    return dPdt 


"""
Nutrients function
"""
#Only diffusive flux, no advection (therefore no sinking)
def fluxN(t,P,N,params):
    J = np.zeros(params.n+1)
    dNdt = np.zeros(params.n)
    for i in range(params.n):
        if i == 0 or i == params.n:
            J[0] = 0
            J[params.n] = -params.D * ((params.nB-N[params.n-1])/params.dz)
        else:
            J[i] = -params.D * (N[i]-N[i-1])/params.dz        
    for i in range(params.n):
        dNdt[i] = -(J[i+1] - J[i])/params.dz 
    dNdt = - growth(N,P,t,params) * P + params.l * P * params.ebselon + dNdt 
    return dNdt 


y = np.concatenate((P,N))

def fluxtot(t,y,params):
    P = y[0:params.n]
    N = y[params.n:2*params.n] #removed the n+1
    dydt=np.concatenate([fluxP(t,P,N,params),fluxN(t,P,N,params)])
    
    return dydt
    
y2 = solve_ivp(fluxtot,t,y,args=(params,))



"""
Grid test
"""
#Test grid
P_4=np.array([7.61865389e-02, 1.38728089e-01, 2.36129263e-01, 2.45435790e-01,
       1.80305392e-01, 1.14985748e-01, 6.93767118e-02, 4.11554368e-02,
       2.43719821e-02, 1.44817053e-02, 8.63730368e-03, 5.17069507e-03,
       3.10116963e-03, 1.86484138e-03, 1.12096060e-03, 6.75860884e-04,
       4.06202274e-04, 2.45582856e-04, 1.47218190e-04, 8.94749590e-05,
       5.33391499e-05, 3.29700764e-05, 2.00121753e-05, 1.43779253e-05,
       1.40780073e-05])
Z_4=np.array([ 2.,  6., 10., 14., 18., 22., 26., 30., 34., 38., 42., 46., 50.,
       54., 58., 62., 66., 70., 74., 78., 82., 86., 90., 94., 98.])
P_2=np.array([5.61535701e-02, 7.80269755e-02, 1.09100467e-01, 1.51705298e-01,
       2.04055854e-01, 2.52699549e-01, 2.63723026e-01, 2.43952648e-01,
       2.09239943e-01, 1.70867286e-01, 1.35162701e-01, 1.04793383e-01,
       8.02717851e-02, 6.10706046e-02, 4.63062704e-02, 3.50647228e-02,
       2.65518108e-02, 2.01162192e-02, 1.52555987e-02, 1.15795786e-02,
       8.79926014e-03, 6.69108598e-03, 5.09327049e-03, 3.87827004e-03,
       2.95598411e-03, 2.25281932e-03, 1.71872517e-03, 1.31049744e-03,
       1.00056031e-03, 7.63007221e-04, 5.82955455e-04, 4.44462859e-04,
       3.39842569e-04, 2.58961508e-04, 1.98208415e-04, 1.50880098e-04,
       1.15656311e-04, 8.78907288e-05, 6.75279498e-05, 5.11828778e-05,
       3.94719398e-05, 2.98126914e-05, 2.31473978e-05, 1.74431860e-05,
       1.37618709e-05, 1.05119840e-05, 8.75069171e-06, 7.37096400e-06,
       7.37651364e-06, 8.46054848e-06])
Z_2=np.array([ 1.,  3.,  5.,  7.,  9., 11., 13., 15., 17., 19., 21., 23., 25.,
       27., 29., 31., 33., 35., 37., 39., 41., 43., 45., 47., 49., 51.,
       53., 55., 57., 59., 61., 63., 65., 67., 69., 71., 73., 75., 77.,
       79., 81., 83., 85., 87., 89., 91., 93., 95., 97., 99.])
P_1=np.array([4.75889896e-02, 5.66717486e-02, 6.75224742e-02, 8.05335360e-02,
       9.61117951e-02, 1.14621283e-01, 1.36278521e-01, 1.60976888e-01,
       1.88025598e-01, 2.15807794e-01, 2.41417797e-01, 2.60379497e-01,
       2.67697110e-01, 2.65437494e-01, 2.55893835e-01, 2.41251671e-01,
       2.23419523e-01, 2.03944121e-01, 1.84016316e-01, 1.64486493e-01,
       1.45934054e-01, 1.28702409e-01, 1.12978056e-01, 9.88108574e-02,
       8.61832813e-02, 7.50080243e-02, 6.51855859e-02, 5.65829441e-02,
       4.90835157e-02, 4.25531964e-02, 3.68868011e-02, 3.19666989e-02,
       2.77082260e-02, 2.40144081e-02, 2.08214091e-02, 1.80514767e-02,
       1.56586333e-02, 1.35811195e-02, 1.17871319e-02, 1.02275368e-02,
       8.88132688e-03, 7.70908548e-03, 6.69783430e-03, 5.81555492e-03,
       5.05515078e-03, 4.39022398e-03, 3.81794002e-03, 3.31618488e-03,
       2.88518249e-03, 2.50610625e-03, 2.18135084e-03, 1.89463591e-03,
       1.64987452e-03, 1.43278038e-03, 1.24830634e-03, 1.08374720e-03,
       9.44744678e-04, 8.19864202e-04, 7.15179358e-04, 6.20291327e-04,
       5.41517658e-04, 4.69316437e-04, 4.10112191e-04, 3.55082743e-04,
       3.10660216e-04, 2.68636178e-04, 2.35378763e-04, 2.03210758e-04,
       1.78385245e-04, 1.53691491e-04, 1.35231564e-04, 1.16210101e-04,
       1.02553209e-04, 8.78403630e-05, 7.78046564e-05, 6.63682902e-05,
       5.90597018e-05, 5.01186719e-05, 4.48607117e-05, 3.78241400e-05,
       3.41048245e-05, 2.85264086e-05, 2.59581577e-05, 2.15019905e-05,
       1.97913919e-05, 1.62067463e-05, 1.51319423e-05, 1.22353031e-05,
       1.16294833e-05, 9.29289804e-06, 9.03311083e-06, 7.17882459e-06,
       7.18020686e-06, 5.78277189e-06, 5.99961807e-06, 5.09861520e-06,
       5.53594256e-06, 5.26580879e-06, 6.00911960e-06, 6.65862109e-06])
Z_1=np.array([ 0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5, 10.5,
       11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20.5, 21.5,
       22.5, 23.5, 24.5, 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5, 32.5,
       33.5, 34.5, 35.5, 36.5, 37.5, 38.5, 39.5, 40.5, 41.5, 42.5, 43.5,
       44.5, 45.5, 46.5, 47.5, 48.5, 49.5, 50.5, 51.5, 52.5, 53.5, 54.5,
       55.5, 56.5, 57.5, 58.5, 59.5, 60.5, 61.5, 62.5, 63.5, 64.5, 65.5,
       66.5, 67.5, 68.5, 69.5, 70.5, 71.5, 72.5, 73.5, 74.5, 75.5, 76.5,
       77.5, 78.5, 79.5, 80.5, 81.5, 82.5, 83.5, 84.5, 85.5, 86.5, 87.5,
       88.5, 89.5, 90.5, 91.5, 92.5, 93.5, 94.5, 95.5, 96.5, 97.5, 98.5,
       99.5])
P_05=np.array([4.34170939e-02, 4.75551564e-02, 5.20692236e-02, 5.70037162e-02,
       6.24063339e-02, 6.83275608e-02, 7.48199358e-02, 8.19368519e-02,
       8.97309364e-02, 9.82516321e-02, 1.07542085e-01, 1.17634792e-01,
       1.28546232e-01, 1.40269784e-01, 1.52767432e-01, 1.65959518e-01,
       1.79713567e-01, 1.93831600e-01, 2.08037745e-01, 2.21965742e-01,
       2.35148965e-01, 2.47012288e-01, 2.56868923e-01, 2.63920726e-01,
       2.68062294e-01, 2.69559345e-01, 2.68701794e-01, 2.65788123e-01,
       2.61115623e-01, 2.54970351e-01, 2.47622990e-01, 2.39322685e-01,
       2.30296977e-01, 2.20747962e-01, 2.10855043e-01, 2.00772233e-01,
       1.90632812e-01, 1.80546921e-01, 1.70607500e-01, 1.60887605e-01,
       1.51447185e-01, 1.42329767e-01, 1.33569805e-01, 1.25188527e-01,
       1.17201695e-01, 1.09614544e-01, 1.02429863e-01, 9.56420351e-02,
       8.92454042e-02, 8.32274766e-02, 7.75775601e-02, 7.22792163e-02,
       6.73191687e-02, 6.26791042e-02, 5.83448447e-02, 5.42975987e-02,
       5.05233833e-02, 4.70038204e-02, 4.37257907e-02, 4.06718606e-02,
       3.78301416e-02, 3.51844244e-02, 3.27242146e-02, 3.04346414e-02,
       2.83066351e-02, 2.63266705e-02, 2.44870529e-02, 2.27755460e-02,
       2.11857333e-02, 1.97065760e-02, 1.83328168e-02, 1.70545064e-02,
       1.58674200e-02, 1.47625857e-02, 1.37366862e-02, 1.27816179e-02,
       1.18948533e-02, 1.10690552e-02, 1.03023778e-02, 9.58815739e-03,
       8.92513288e-03, 8.30723120e-03, 7.73369004e-03, 7.19895350e-03,
       6.70268283e-03, 6.23977499e-03, 5.81024933e-03, 5.40939968e-03,
       5.03754687e-03, 4.69033303e-03, 4.36833169e-03, 4.06749128e-03,
       3.78859614e-03, 3.52786475e-03, 3.28625633e-03, 3.06022811e-03,
       2.85088349e-03, 2.65489147e-03, 2.47347336e-03, 2.30348663e-03,
       2.14624811e-03, 1.99878360e-03, 1.86248633e-03, 1.73453304e-03,
       1.61637707e-03, 1.50533101e-03, 1.40289444e-03, 1.30650272e-03,
       1.21768989e-03, 1.13400270e-03, 1.05699958e-03, 9.84328784e-04,
       9.17564640e-04, 8.54448246e-04, 7.96562595e-04, 7.41734065e-04,
       6.91548209e-04, 6.43910050e-04, 6.00402539e-04, 5.59003509e-04,
       5.21288962e-04, 4.85304403e-04, 4.52615231e-04, 4.21330080e-04,
       3.93000694e-04, 3.65794811e-04, 3.41247975e-04, 3.17583456e-04,
       2.96318490e-04, 2.75728693e-04, 2.57311262e-04, 2.39391316e-04,
       2.23444598e-04, 2.07843186e-04, 1.94040224e-04, 1.80452465e-04,
       1.68509547e-04, 1.56670837e-04, 1.46341753e-04, 1.36022425e-04,
       1.27093500e-04, 1.18094197e-04, 1.10379979e-04, 1.02527642e-04,
       9.58671699e-05, 8.90115639e-05, 8.32651227e-05, 7.72758212e-05,
       7.23221373e-05, 6.70859086e-05, 6.28197113e-05, 5.82382521e-05,
       5.45681606e-05, 5.05561314e-05, 4.74028210e-05, 4.38861428e-05,
       4.11807548e-05, 3.80951333e-05, 3.57778961e-05, 3.30675439e-05,
       3.10865768e-05, 2.87031087e-05, 2.70133870e-05, 2.49148656e-05,
       2.34773240e-05, 2.16274394e-05, 2.04081992e-05, 1.87755655e-05,
       1.77452693e-05, 1.63028274e-05, 1.54360711e-05, 1.41605873e-05,
       1.34354400e-05, 1.23070943e-05, 1.17047000e-05, 1.07067604e-05,
       1.02110189e-05, 9.32960240e-06, 8.92692967e-06, 8.15085355e-06,
       7.83002613e-06, 7.15075974e-06, 6.90285445e-06, 6.31458727e-06,
       6.13303294e-06, 5.63288457e-06, 5.51365318e-06, 5.10206192e-06,
       5.04403925e-06, 4.72538243e-06, 4.73097563e-06, 4.51449629e-06,
       4.59056047e-06, 4.49170503e-06, 4.65090390e-06, 4.69321605e-06,
       4.95597804e-06, 5.17375064e-06, 5.57104546e-06, 6.01300936e-06])
Z_05=np.array([ 0.25,  0.75,  1.25,  1.75,  2.25,  2.75,  3.25,  3.75,  4.25,
        4.75,  5.25,  5.75,  6.25,  6.75,  7.25,  7.75,  8.25,  8.75,
        9.25,  9.75, 10.25, 10.75, 11.25, 11.75, 12.25, 12.75, 13.25,
       13.75, 14.25, 14.75, 15.25, 15.75, 16.25, 16.75, 17.25, 17.75,
       18.25, 18.75, 19.25, 19.75, 20.25, 20.75, 21.25, 21.75, 22.25,
       22.75, 23.25, 23.75, 24.25, 24.75, 25.25, 25.75, 26.25, 26.75,
       27.25, 27.75, 28.25, 28.75, 29.25, 29.75, 30.25, 30.75, 31.25,
       31.75, 32.25, 32.75, 33.25, 33.75, 34.25, 34.75, 35.25, 35.75,
       36.25, 36.75, 37.25, 37.75, 38.25, 38.75, 39.25, 39.75, 40.25,
       40.75, 41.25, 41.75, 42.25, 42.75, 43.25, 43.75, 44.25, 44.75,
       45.25, 45.75, 46.25, 46.75, 47.25, 47.75, 48.25, 48.75, 49.25,
       49.75, 50.25, 50.75, 51.25, 51.75, 52.25, 52.75, 53.25, 53.75,
       54.25, 54.75, 55.25, 55.75, 56.25, 56.75, 57.25, 57.75, 58.25,
       58.75, 59.25, 59.75, 60.25, 60.75, 61.25, 61.75, 62.25, 62.75,
       63.25, 63.75, 64.25, 64.75, 65.25, 65.75, 66.25, 66.75, 67.25,
       67.75, 68.25, 68.75, 69.25, 69.75, 70.25, 70.75, 71.25, 71.75,
       72.25, 72.75, 73.25, 73.75, 74.25, 74.75, 75.25, 75.75, 76.25,
       76.75, 77.25, 77.75, 78.25, 78.75, 79.25, 79.75, 80.25, 80.75,
       81.25, 81.75, 82.25, 82.75, 83.25, 83.75, 84.25, 84.75, 85.25,
       85.75, 86.25, 86.75, 87.25, 87.75, 88.25, 88.75, 89.25, 89.75,
       90.25, 90.75, 91.25, 91.75, 92.25, 92.75, 93.25, 93.75, 94.25,
       94.75, 95.25, 95.75, 96.25, 96.75, 97.25, 97.75, 98.25, 98.75,
       99.25, 99.75])
P_025=np.array([4.12889603e-02, 4.32614283e-02, 4.53201585e-02, 4.74702549e-02,
       4.97170918e-02, 5.20662173e-02, 5.45234720e-02, 5.70948182e-02,
       5.97865250e-02, 6.26049124e-02, 6.55566098e-02, 6.86482021e-02,
       7.18865689e-02, 7.52784182e-02, 7.88307142e-02, 8.25500804e-02,
       8.64433268e-02, 9.05167007e-02, 9.47765237e-02, 9.92282675e-02,
       1.03877313e-01, 1.08727823e-01, 1.13783639e-01, 1.19046924e-01,
       1.24519209e-01, 1.30199778e-01, 1.36086893e-01, 1.42175874e-01,
       1.48460548e-01, 1.54930987e-01, 1.61575214e-01, 1.68376580e-01,
       1.75315772e-01, 1.82367801e-01, 1.89504387e-01, 1.96690526e-01,
       2.03887335e-01, 2.11048176e-01, 2.18122057e-01, 2.25049277e-01,
       2.31765500e-01, 2.38196874e-01, 2.44264901e-01, 2.49880959e-01,
       2.54952114e-01, 2.59374954e-01, 2.63042495e-01, 2.65951025e-01,
       2.68133963e-01, 2.69622816e-01, 2.70455585e-01, 2.70666576e-01,
       2.70296308e-01, 2.69379956e-01, 2.67958929e-01, 2.66067763e-01,
       2.63747521e-01, 2.61030963e-01, 2.57957911e-01, 2.54558525e-01,
       2.50870776e-01, 2.46921658e-01, 2.42746909e-01, 2.38370010e-01,
       2.33824263e-01, 2.29129454e-01, 2.24316393e-01, 2.19401121e-01,
       2.14412005e-01, 2.09361392e-01, 2.04275337e-01, 1.99162618e-01,
       1.94047159e-01, 1.88934351e-01, 1.83846209e-01, 1.78784947e-01,
       1.73770911e-01, 1.68803377e-01, 1.63901264e-01, 1.59061158e-01,
       1.54300797e-01, 1.49614321e-01, 1.45018517e-01, 1.40505326e-01,
       1.36090799e-01, 1.31764907e-01, 1.27543166e-01, 1.23413791e-01,
       1.19391942e-01, 1.15464282e-01, 1.11645766e-01, 1.07921687e-01,
       1.04306932e-01, 1.00785594e-01, 9.73725999e-02, 9.40509920e-02,
       9.08358311e-02, 8.77092443e-02, 8.46865000e-02, 8.17489285e-02,
       7.89120640e-02, 7.61565460e-02, 7.34982172e-02, 7.09171198e-02,
       6.84294350e-02, 6.60146903e-02, 6.36894246e-02, 6.14327231e-02,
       5.92614919e-02, 5.71544382e-02, 5.51288368e-02, 5.31630734e-02,
       5.12747869e-02, 4.94420913e-02, 4.76829796e-02, 4.59753381e-02,
       4.43375000e-02, 4.27471629e-02, 4.12229828e-02, 3.97425040e-02,
       3.83246848e-02, 3.69469478e-02, 3.56285323e-02, 3.43467667e-02,
       3.31211489e-02, 3.19289385e-02, 3.07898685e-02, 2.96811526e-02,
       2.86227351e-02, 2.75918048e-02, 2.66084935e-02, 2.56499839e-02,
       2.47365724e-02, 2.38454529e-02, 2.29970631e-02, 2.21686240e-02,
       2.13806929e-02, 2.06105324e-02, 1.98787977e-02, 1.91628064e-02,
       1.84832914e-02, 1.78176376e-02, 1.71866360e-02, 1.65677499e-02,
       1.59818101e-02, 1.54063688e-02, 1.48622789e-02, 1.43271913e-02,
       1.38219644e-02, 1.33243565e-02, 1.28552163e-02, 1.23924174e-02,
       1.19567842e-02, 1.15263134e-02, 1.11217914e-02, 1.07213446e-02,
       1.03457091e-02, 9.97314736e-03, 9.62433309e-03, 9.27767068e-03,
       8.95376077e-03, 8.63115477e-03, 8.33037021e-03, 8.03011030e-03,
       7.75080019e-03, 7.47129920e-03, 7.21193161e-03, 6.95171671e-03,
       6.71087014e-03, 6.46857462e-03, 6.24492999e-03, 6.01928556e-03,
       5.81161886e-03, 5.60144854e-03, 5.40862391e-03, 5.21283538e-03,
       5.03379867e-03, 4.85137812e-03, 4.68515099e-03, 4.51515739e-03,
       4.36083176e-03, 4.20239156e-03, 4.05912451e-03, 3.91142672e-03,
       3.77843572e-03, 3.64072736e-03, 3.51728589e-03, 3.38886776e-03,
       3.27430120e-03, 3.15452396e-03, 3.04820587e-03, 2.93646644e-03,
       2.83781501e-03, 2.73355318e-03, 2.64202802e-03, 2.54472335e-03,
       2.45982249e-03, 2.36899144e-03, 2.29024852e-03, 2.20544179e-03,
       2.13242353e-03, 2.05322357e-03, 1.98552736e-03, 1.91154609e-03,
       1.84879778e-03, 1.77967447e-03, 1.72152633e-03, 1.65692566e-03,
       1.60305449e-03, 1.54266468e-03, 1.49277006e-03, 1.43630122e-03,
       1.39010385e-03, 1.33728642e-03, 1.29452665e-03, 1.24510994e-03,
       1.20554634e-03, 1.15929719e-03, 1.12270526e-03, 1.07940679e-03,
       1.04557778e-03, 1.00502825e-03, 9.73768020e-04, 9.35779729e-04,
       9.06907723e-04, 8.71306046e-04, 8.44654329e-04, 8.11276783e-04,
       7.86689151e-04, 7.55384536e-04, 7.32715689e-04, 7.03343300e-04,
       6.82458073e-04, 6.54886957e-04, 6.35659611e-04, 6.09767884e-04,
       5.92081442e-04, 5.67755656e-04, 5.51501284e-04, 5.28635834e-04,
       5.13712278e-04, 4.92208853e-04, 4.78521903e-04, 4.58288977e-04,
       4.45750976e-04, 4.26703338e-04, 4.15232725e-04, 3.97291031e-04,
       3.86811915e-04, 3.69902287e-04, 3.60344051e-04, 3.44397694e-04,
       3.35694627e-04, 3.20647476e-04, 3.12738432e-04, 2.98530823e-04,
       2.91358906e-04, 2.77935269e-04, 2.71447532e-04, 2.58756113e-04,
       2.52903288e-04, 2.40895877e-04, 2.35632118e-04, 2.24263812e-04,
       2.19546455e-04, 2.08775422e-04, 2.04564770e-04, 1.94352040e-04,
       1.90611151e-04, 1.80920421e-04, 1.77614918e-04, 1.68412364e-04,
       1.65510261e-04, 1.56764369e-04, 1.54235901e-04, 1.45917308e-04,
       1.43734780e-04, 1.35816124e-04, 1.33953764e-04, 1.26409551e-04,
       1.24843379e-04, 1.17649852e-04, 1.16357555e-04, 1.09492573e-04,
       1.08453391e-04, 1.01896321e-04, 1.01090936e-04, 9.48225504e-05,
       9.42329868e-05, 8.82353664e-05, 8.78448997e-05, 8.21013439e-05,
       8.18944115e-05, 7.63893566e-05, 7.63514775e-05, 7.10704190e-05,
       7.11881180e-05, 6.61175394e-05, 6.63782764e-05, 6.15055825e-05,
       6.18976868e-05, 5.72111417e-05, 5.77237511e-05, 5.32124209e-05,
       5.38354238e-05, 4.94891236e-05, 5.02131059e-05, 4.60223501e-05,
       4.68385453e-05, 4.27945017e-05, 4.36947442e-05, 3.97891921e-05,
       4.07658735e-05, 3.69911640e-05, 3.80371923e-05, 3.43862122e-05,
       3.54949735e-05, 3.19611124e-05, 3.31264348e-05, 2.97035538e-05,
       3.09196740e-05, 2.76020777e-05, 2.88636090e-05, 2.56460201e-05,
       2.69479223e-05, 2.38254579e-05, 2.51630095e-05, 2.21311597e-05,
       2.34999308e-05, 2.05545399e-05, 2.19503671e-05, 1.90876163e-05,
       2.05065781e-05, 1.77229709e-05, 1.91613650e-05, 1.64537138e-05,
       1.79080350e-05, 1.52734500e-05, 1.67403687e-05, 1.41762490e-05,
       1.56525910e-05, 1.31566174e-05, 1.46393436e-05, 1.22094734e-05,
       1.36956609e-05, 1.13301249e-05, 1.28169475e-05, 1.05142489e-05,
       1.19989588e-05, 9.75787490e-06, 1.12377837e-05, 9.05736929e-06,
       1.05298302e-05, 8.40942370e-06, 9.87181268e-06, 7.81104532e-06,
       9.26074287e-06, 7.25955037e-06, 8.69392289e-06, 6.75256055e-06,
       8.16894160e-06, 6.28800288e-06, 7.68367412e-06, 5.86411311e-06,
       7.23628500e-06, 5.47944316e-06, 6.82523533e-06, 5.13287312e-06,
       6.44929436e-06, 4.82362818e-06, 6.10755623e-06, 4.55130145e-06,
       5.79946242e-06, 4.31588327e-06, 5.52483101e-06, 4.11779814e-06,
       5.28389352e-06, 3.95795037e-06, 5.07734077e-06, 3.83777991e-06,
       4.90637914e-06, 3.75932992e-06, 4.77279900e-06, 3.72532815e-06,
       4.67905731e-06, 3.73928437e-06, 4.62837699e-06, 3.80560665e-06,
       4.62486578e-06, 3.92973967e-06, 4.67365818e-06, 4.11832891e-06,
       4.78108438e-06, 4.37941526e-06, 4.95487115e-06, 4.72266535e-06,
       5.20438015e-06, 5.15964381e-06, 5.54089052e-06, 5.70413505e-06])
Z_025=np.array([ 0.125,  0.375,  0.625,  0.875,  1.125,  1.375,  1.625,  1.875,
          
        2.125,  2.375,  2.625,  2.875,  3.125,  3.375,  3.625,  3.875,
        4.125,  4.375,  4.625,  4.875,  5.125,  5.375,  5.625,  5.875,
        6.125,  6.375,  6.625,  6.875,  7.125,  7.375,  7.625,  7.875,
        8.125,  8.375,  8.625,  8.875,  9.125,  9.375,  9.625,  9.875,
       10.125, 10.375, 10.625, 10.875, 11.125, 11.375, 11.625, 11.875,
       12.125, 12.375, 12.625, 12.875, 13.125, 13.375, 13.625, 13.875,
       14.125, 14.375, 14.625, 14.875, 15.125, 15.375, 15.625, 15.875,
       16.125, 16.375, 16.625, 16.875, 17.125, 17.375, 17.625, 17.875,
       18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875,
       20.125, 20.375, 20.625, 20.875, 21.125, 21.375, 21.625, 21.875,
       22.125, 22.375, 22.625, 22.875, 23.125, 23.375, 23.625, 23.875,
       24.125, 24.375, 24.625, 24.875, 25.125, 25.375, 25.625, 25.875,
       26.125, 26.375, 26.625, 26.875, 27.125, 27.375, 27.625, 27.875,
       28.125, 28.375, 28.625, 28.875, 29.125, 29.375, 29.625, 29.875,
       30.125, 30.375, 30.625, 30.875, 31.125, 31.375, 31.625, 31.875,
       32.125, 32.375, 32.625, 32.875, 33.125, 33.375, 33.625, 33.875,
       34.125, 34.375, 34.625, 34.875, 35.125, 35.375, 35.625, 35.875,
       36.125, 36.375, 36.625, 36.875, 37.125, 37.375, 37.625, 37.875,
       38.125, 38.375, 38.625, 38.875, 39.125, 39.375, 39.625, 39.875,
       40.125, 40.375, 40.625, 40.875, 41.125, 41.375, 41.625, 41.875,
       42.125, 42.375, 42.625, 42.875, 43.125, 43.375, 43.625, 43.875,
       44.125, 44.375, 44.625, 44.875, 45.125, 45.375, 45.625, 45.875,
       46.125, 46.375, 46.625, 46.875, 47.125, 47.375, 47.625, 47.875,
       48.125, 48.375, 48.625, 48.875, 49.125, 49.375, 49.625, 49.875,
       50.125, 50.375, 50.625, 50.875, 51.125, 51.375, 51.625, 51.875,
       52.125, 52.375, 52.625, 52.875, 53.125, 53.375, 53.625, 53.875,
       54.125, 54.375, 54.625, 54.875, 55.125, 55.375, 55.625, 55.875,
       56.125, 56.375, 56.625, 56.875, 57.125, 57.375, 57.625, 57.875,
       58.125, 58.375, 58.625, 58.875, 59.125, 59.375, 59.625, 59.875,
       60.125, 60.375, 60.625, 60.875, 61.125, 61.375, 61.625, 61.875,
       62.125, 62.375, 62.625, 62.875, 63.125, 63.375, 63.625, 63.875,
       64.125, 64.375, 64.625, 64.875, 65.125, 65.375, 65.625, 65.875,
       66.125, 66.375, 66.625, 66.875, 67.125, 67.375, 67.625, 67.875,
       68.125, 68.375, 68.625, 68.875, 69.125, 69.375, 69.625, 69.875,
       70.125, 70.375, 70.625, 70.875, 71.125, 71.375, 71.625, 71.875,
       72.125, 72.375, 72.625, 72.875, 73.125, 73.375, 73.625, 73.875,
       74.125, 74.375, 74.625, 74.875, 75.125, 75.375, 75.625, 75.875,
       76.125, 76.375, 76.625, 76.875, 77.125, 77.375, 77.625, 77.875,
       78.125, 78.375, 78.625, 78.875, 79.125, 79.375, 79.625, 79.875,
       80.125, 80.375, 80.625, 80.875, 81.125, 81.375, 81.625, 81.875,
       82.125, 82.375, 82.625, 82.875, 83.125, 83.375, 83.625, 83.875,
       84.125, 84.375, 84.625, 84.875, 85.125, 85.375, 85.625, 85.875,
       86.125, 86.375, 86.625, 86.875, 87.125, 87.375, 87.625, 87.875,
       88.125, 88.375, 88.625, 88.875, 89.125, 89.375, 89.625, 89.875,
       90.125, 90.375, 90.625, 90.875, 91.125, 91.375, 91.625, 91.875,
       92.125, 92.375, 92.625, 92.875, 93.125, 93.375, 93.625, 93.875,
       94.125, 94.375, 94.625, 94.875, 95.125, 95.375, 95.625, 95.875,
       96.125, 96.375, 96.625, 96.875, 97.125, 97.375, 97.625, 97.875,
       98.125, 98.375, 98.625, 98.875, 99.125, 99.375, 99.625, 99.875])


#Plot of grid test
plt.figure(dpi=1200)
plt.plot(P_4,-Z_4,label='$\delta z$ = 4.0 m',linewidth=1.0,color='black')
plt.plot(P_2,-Z_2,label='$\delta z$ = 2.0 m',linewidth=0.8,color='black')
plt.plot(P_1,-Z_1,label='$\delta z$ = 1.0 m',linewidth=0.6,color='black')
plt.plot(P_05,-Z_05,label='$\delta z$ = 0.5 m',linewidth=0.4,color='black')
plt.plot(P_025,-Z_025,label='$\delta z$ = 0.25 m',linewidth=0.2,color='black')
plt.xlabel('Phytoplankton (mmol N/m^3)')
plt.ylabel('Depth (m)')
plt.title('Grid size analysis')
plt.ylim([-100,-0])
plt.xlim([0.125, 0.275])
plt.legend()
plt.show()

"""
Sensitivity analysis 
"""
#Sensitivity analysis
gmax10=np.array([4.93202631e-02, 5.89724177e-02, 7.07926078e-02, 8.53140957e-02,
       1.03119626e-01, 1.24777663e-01, 1.50709051e-01, 1.80937687e-01,
       2.14688972e-01, 2.49832175e-01, 2.82282770e-01, 3.05579545e-01,
       3.14132486e-01, 3.10810150e-01, 2.98673380e-01, 2.80539583e-01,
       2.58800346e-01, 2.35335831e-01, 2.11561276e-01, 1.88452459e-01,
       1.66660626e-01, 1.46545566e-01, 1.28295019e-01, 1.11930244e-01,
       9.74106592e-02, 8.46083241e-02, 7.33976473e-02, 6.36068881e-02,
       5.50979381e-02, 4.77043481e-02, 4.13054140e-02, 3.57579783e-02,
       3.09670397e-02, 2.68159985e-02, 2.32345028e-02, 2.01299030e-02,
       1.74522773e-02, 1.51286507e-02, 1.31248815e-02, 1.13834712e-02,
       9.88199259e-03, 8.57488480e-03, 7.44820444e-03, 6.46553697e-03,
       5.61897505e-03, 4.87911804e-03, 4.24228835e-03, 3.68449281e-03,
       3.20497031e-03, 2.78393016e-03, 2.42258148e-03, 2.10443074e-03,
       1.83197959e-03, 1.59134803e-03, 1.38584741e-03, 1.20369135e-03,
       1.04865891e-03, 9.10658619e-04, 7.93696892e-04, 6.89068730e-04,
       6.00840879e-04, 5.21453936e-04, 4.54920887e-04, 3.94638056e-04,
       3.44488691e-04, 2.98673774e-04, 2.60898233e-04, 2.26046372e-04,
       1.97615822e-04, 1.71075843e-04, 1.49701713e-04, 1.29467185e-04,
       1.13419884e-04, 9.79716724e-05, 8.59439399e-05, 7.41314591e-05,
       6.51352663e-05, 5.60868599e-05, 4.93755961e-05, 4.24309031e-05,
       3.74406525e-05, 3.20996282e-05, 2.84049237e-05, 2.42895587e-05,
       2.15702016e-05, 1.83960690e-05, 1.64125690e-05, 1.39682293e-05,
       1.25442548e-05, 1.06773996e-05, 9.68846894e-06, 8.29863596e-06,
       7.66731485e-06, 6.70631220e-06, 6.40571723e-06, 5.88897581e-06,
       5.95896387e-06, 5.99464701e-06, 6.57970046e-06, 7.42894846e-06])
gmax20=np.array([3.84440152e-02, 4.61193164e-02, 5.56844535e-02, 6.76334706e-02,
       8.25492761e-02, 1.01083021e-01, 1.23890707e-01, 1.51478492e-01,
       1.83899669e-01, 2.20218622e-01, 2.57740099e-01, 2.91135162e-01,
       3.11892587e-01, 3.17385622e-01, 3.11018334e-01, 2.96194223e-01,
       2.75937904e-01, 2.52676111e-01, 2.28281651e-01, 2.04053157e-01,
       1.80896750e-01, 1.59317139e-01, 1.39625957e-01, 1.21885587e-01,
       1.06112172e-01, 9.21677856e-02, 7.99548157e-02, 6.92700077e-02,
       5.99935680e-02, 5.19205697e-02, 4.49469784e-02, 3.88906670e-02,
       3.36742888e-02, 2.91443504e-02, 2.52494825e-02, 2.18630487e-02,
       1.89549826e-02, 1.64213463e-02, 1.42481122e-02, 1.23496938e-02,
       1.07235009e-02, 9.29853029e-03, 8.08000107e-03, 7.00846326e-03,
       6.09423518e-03, 5.28706213e-03, 4.60040107e-03, 3.99138068e-03,
       3.47520914e-03, 3.01500757e-03, 2.62677112e-03, 2.27853998e-03,
       1.98643816e-03, 1.72258910e-03, 1.50280653e-03, 1.30263923e-03,
       1.13730676e-03, 9.85259342e-04, 8.60947928e-04, 7.45302053e-04,
       6.51906243e-04, 5.63825359e-04, 4.93732848e-04, 4.26545505e-04,
       3.74017505e-04, 3.22681726e-04, 2.83389386e-04, 2.44091306e-04,
       2.14768079e-04, 1.84620567e-04, 1.62801015e-04, 1.39616955e-04,
       1.23440191e-04, 1.05561693e-04, 9.36232861e-05, 7.97928937e-05,
       7.10331758e-05, 6.02966853e-05, 5.39164652e-05, 4.55496042e-05,
       4.09465617e-05, 3.43997495e-05, 3.11204841e-05, 2.59773988e-05,
       2.36814164e-05, 1.96282792e-05, 1.80612357e-05, 1.48647127e-05,
       1.38391227e-05, 1.13316884e-05, 1.07141939e-05, 8.78686327e-06,
       8.49223703e-06, 7.09604244e-06, 7.08969748e-06, 6.24961711e-06,
       6.56308897e-06, 6.41217621e-06, 7.18089824e-06, 8.02965342e-06]) 
gmax30=np.array([3.04494802e-02, 3.66202614e-02, 4.44088879e-02, 5.42544243e-02,
       6.66970049e-02, 8.23832544e-02, 1.02049235e-01, 1.26449561e-01,
       1.56176070e-01, 1.91269632e-01, 2.30512123e-01, 2.70355851e-01,
       3.03740442e-01, 3.19465379e-01, 3.20138455e-01, 3.09638225e-01,
       2.91600528e-01, 2.69064516e-01, 2.44388424e-01, 2.19274702e-01,
       1.94886122e-01, 1.71942079e-01, 1.50851416e-01, 1.31780951e-01,
       1.14758156e-01, 9.96974460e-02, 8.64730743e-02, 7.49137114e-02,
       6.48562339e-02, 5.61216705e-02, 4.85588158e-02, 4.20110013e-02,
       3.63547067e-02, 3.14628218e-02, 2.72406343e-02, 2.35886666e-02,
       2.04368786e-02, 1.77086615e-02, 1.53534002e-02, 1.33123903e-02,
       1.15496655e-02, 1.00201727e-02, 8.69873365e-03, 7.55058557e-03,
       6.55838719e-03, 5.69511071e-03, 4.94906063e-03, 4.29903589e-03,
       3.73738400e-03, 3.24731595e-03, 2.82405867e-03, 2.45418719e-03,
       2.13496584e-03, 1.85555498e-03, 1.61464787e-03, 1.40340851e-03,
       1.22151964e-03, 1.06171166e-03, 9.24339623e-04, 8.03369347e-04,
       6.99599740e-04, 6.07979627e-04, 5.29587744e-04, 4.60162045e-04,
       4.00943966e-04, 3.48310552e-04, 3.03583018e-04, 2.63660518e-04,
       2.29886072e-04, 1.99589057e-04, 1.74094498e-04, 1.51089282e-04,
       1.31853851e-04, 1.14374630e-04, 9.98704420e-05, 8.65807004e-05,
       7.56524209e-05, 6.55403831e-05, 5.73144521e-05, 4.96142094e-05,
       4.34303669e-05, 3.75624272e-05, 3.29221510e-05, 2.84487841e-05,
       2.49766618e-05, 2.15686735e-05, 1.89838662e-05, 1.63964844e-05,
       1.44924249e-05, 1.25489613e-05, 1.11804214e-05, 9.76347029e-06,
       8.84135922e-06, 7.89279093e-06, 7.38886299e-06, 6.92225497e-06,
       6.88895866e-06, 7.02225647e-06, 7.63842332e-06, 8.66215824e-06])
gmax40=np.array([2.51847702e-02, 3.03399457e-02, 3.69010119e-02, 4.52569498e-02,
       5.58967035e-02, 6.94244156e-02, 8.65661442e-02, 1.08142760e-01,
       1.34972609e-01, 1.67608920e-01, 2.05785971e-01, 2.47392511e-01,
       2.87000930e-01, 3.14436129e-01, 3.23704302e-01, 3.18873780e-01,
       3.04136100e-01, 2.83126992e-01, 2.58773709e-01, 2.33189705e-01,
       2.07891305e-01, 1.83787395e-01, 1.61476916e-01, 1.41175151e-01,
       1.23013696e-01, 1.06882585e-01, 9.27236516e-02, 8.03083353e-02,
       6.95288343e-02, 6.01364895e-02, 5.20329162e-02, 4.49889903e-02,
       3.89343373e-02, 3.36710423e-02, 2.91578725e-02, 2.52281406e-02,
       2.18647438e-02, 1.89282547e-02, 1.64194955e-02, 1.42215895e-02,
       1.23477450e-02, 1.06993710e-02, 9.29769024e-03, 8.05888617e-03,
       7.00895707e-03, 6.07608195e-03, 5.28872819e-03, 4.58490042e-03,
       3.99394097e-03, 3.46198644e-03, 3.01818239e-03, 2.61546654e-03,
       2.28209023e-03, 1.97673567e-03, 1.72632632e-03, 1.49444004e-03,
       1.30642246e-03, 1.13005681e-03, 9.88987480e-04, 8.54635182e-04,
       7.48905571e-04, 6.46384577e-04, 5.67258887e-04, 4.88883045e-04,
       4.29781680e-04, 3.69741938e-04, 3.25706328e-04, 2.79607686e-04,
       2.46899522e-04, 2.11413684e-04, 1.87214158e-04, 1.59818458e-04,
       1.42002146e-04, 1.20782995e-04, 1.07747629e-04, 9.12523615e-05,
       8.17905285e-05, 6.89156451e-05, 6.21180246e-05, 5.20249002e-05,
       4.72072647e-05, 3.92586590e-05, 3.59068520e-05, 2.96193118e-05,
       2.73479111e-05, 2.23565194e-05, 2.08780872e-05, 1.69111647e-05,
       1.60140006e-05, 1.28764567e-05, 1.24097751e-05, 9.97505147e-06,
       9.84172072e-06, 8.05397851e-06, 8.21275707e-06, 7.10368594e-06,
       7.58592310e-06, 7.31526089e-06, 8.26650547e-06, 9.20384417e-06])
gmax50=np.array([2.07568456e-02, 2.50436567e-02, 3.05394636e-02, 3.75840377e-02,
       4.66108263e-02, 5.81681748e-02, 7.29392725e-02, 9.17477885e-02,
       1.15523881e-01, 1.45165551e-01, 1.81176838e-01, 2.22870900e-01,
       2.66929848e-01, 3.05413617e-01, 3.24262486e-01, 3.26028089e-01,
       3.15313024e-01, 2.96365159e-01, 2.72679203e-01, 2.46865434e-01,
       2.20781962e-01, 1.95615613e-01, 1.72110713e-01, 1.50618567e-01,
       1.31304878e-01, 1.14126122e-01, 9.90058564e-02, 8.57535658e-02,
       7.42220762e-02, 6.41914885e-02, 5.55176213e-02, 4.79983088e-02,
       4.15172761e-02, 3.59039805e-02, 3.10736725e-02, 2.68875894e-02,
       2.32883256e-02, 2.01644183e-02, 1.74797502e-02, 1.51448555e-02,
       1.31392522e-02, 1.13907263e-02, 9.88985232e-03, 8.57782825e-03,
       7.45281439e-03, 6.46644850e-03, 5.62193970e-03, 4.87910664e-03,
       4.24439284e-03, 3.68408991e-03, 3.20659734e-03, 2.78338478e-03,
       2.42391787e-03, 2.10385551e-03, 1.83311791e-03, 1.59079094e-03,
       1.38683555e-03, 1.20317058e-03, 1.04952393e-03, 9.10179204e-04,
       7.94456238e-04, 6.88630316e-04, 6.01507526e-04, 5.21054247e-04,
       4.55505599e-04, 3.94274347e-04, 3.45000952e-04, 2.98343376e-04,
       2.61346602e-04, 2.25746856e-04, 1.98008072e-04, 1.70805050e-04,
       1.50044906e-04, 1.29223237e-04, 1.13720469e-04, 9.77530356e-05,
       8.62079089e-05, 7.39371050e-05, 6.53684389e-05, 5.59166002e-05,
       4.95841104e-05, 4.22860368e-05, 3.76318493e-05, 3.19841560e-05,
       2.85889586e-05, 2.42124506e-05, 2.17630264e-05, 1.83754954e-05,
       1.66414931e-05, 1.40394641e-05, 1.28583649e-05, 1.09075953e-05,
       1.01781917e-05, 8.81446463e-06, 8.50117483e-06, 7.74570498e-06,
       7.89942369e-06, 7.89800422e-06, 8.70525154e-06, 9.80899297e-06])
gmax60=np.array([1.77999648e-02, 2.14982827e-02, 2.62626407e-02, 3.23951885e-02,
       4.02843666e-02, 5.04274184e-02, 6.34550827e-02, 8.01511608e-02,
       1.01449941e-01, 1.28365701e-01, 1.61757683e-01, 2.01733492e-01,
       2.46397545e-01, 2.89738174e-01, 3.19242190e-01, 3.28785101e-01,
       3.23142098e-01, 3.07090886e-01, 2.84708754e-01, 2.59128004e-01,
       2.32600812e-01, 2.06612773e-01, 1.82095759e-01, 1.59539978e-01,
       1.39177017e-01, 1.21020478e-01, 1.05002062e-01, 9.09534650e-02,
       7.87121819e-02, 6.80681382e-02, 5.88542113e-02, 5.08750526e-02,
       4.39904509e-02, 3.80369608e-02, 3.29073451e-02, 2.84709822e-02,
       2.46501291e-02, 2.13423619e-02, 1.84934117e-02, 1.60233653e-02,
       1.38955909e-02, 1.20475651e-02, 1.04554830e-02, 9.07007973e-03,
       7.87668789e-03, 6.83612618e-03, 5.94013770e-03, 5.15723841e-03,
       4.48360576e-03, 3.89367387e-03, 3.38663891e-03, 2.94152691e-03,
       2.55954551e-03, 2.22331965e-03, 1.93535529e-03, 1.68112745e-03,
       1.46393794e-03, 1.27154233e-03, 1.10768641e-03, 9.61969068e-04,
       8.38335857e-04, 7.27890151e-04, 6.34609991e-04, 5.50838136e-04,
       4.80472831e-04, 4.16886859e-04, 3.63825637e-04, 3.15525101e-04,
       2.75532738e-04, 2.38813435e-04, 2.08691382e-04, 1.80751571e-04,
       1.58083340e-04, 1.36802767e-04, 1.19762310e-04, 1.03535786e-04,
       9.07431200e-05, 7.83550443e-05, 6.87673955e-05, 5.92971511e-05,
       5.21268805e-05, 4.48775491e-05, 3.95303659e-05, 3.39752120e-05,
       3.00038836e-05, 2.57465621e-05, 2.28167006e-05, 1.95624150e-05,
       1.74280942e-05, 1.49641185e-05, 1.34522646e-05, 1.16375641e-05,
       1.06415187e-05, 9.40701523e-06, 8.89182966e-06, 8.25573843e-06,
       8.28138426e-06, 8.38905547e-06, 9.16423779e-06, 1.03710210e-05])
gmax70=np.array([1.51468602e-02, 1.83112599e-02, 2.24057226e-02, 2.76957778e-02,
       3.45250652e-02, 4.33376159e-02, 5.47051709e-02, 6.93553510e-02,
       8.81928810e-02, 1.12283521e-01, 1.42736471e-01, 1.80325911e-01,
       2.24563191e-01, 2.71800701e-01, 3.12336385e-01, 3.30231767e-01,
       3.30192670e-01, 3.17434431e-01, 2.96625268e-01, 2.71432436e-01,
       2.44551415e-01, 2.17771956e-01, 1.92257465e-01, 1.68622018e-01,
       1.47202370e-01, 1.28040256e-01, 1.11114523e-01, 9.62422373e-02,
       8.32859861e-02, 7.20047129e-02, 6.22500124e-02, 5.37910045e-02,
       4.65055550e-02, 4.01950150e-02, 3.47710641e-02, 3.00700399e-02,
       2.60338609e-02, 2.25297896e-02, 1.95234270e-02, 1.69073314e-02,
       1.46644053e-02, 1.27072510e-02, 1.10308426e-02, 9.56350041e-03,
       8.30830292e-03, 7.20590588e-03, 6.26460641e-03, 5.43480631e-03,
       4.72797597e-03, 4.10229242e-03, 3.57097668e-03, 3.09847654e-03,
       2.69879036e-03, 2.34147932e-03, 2.04066526e-03, 1.77012322e-03,
       1.54366964e-03, 1.33858637e-03, 1.16811289e-03, 1.01247572e-03,
       8.84175255e-04, 7.65930649e-04, 6.69416632e-04, 5.79477659e-04,
       5.06927843e-04, 4.38435415e-04, 3.83953675e-04, 3.31724868e-04,
       2.90864110e-04, 2.50979034e-04, 2.20383643e-04, 1.89875357e-04,
       1.67012665e-04, 1.43633994e-04, 1.26592294e-04, 1.08640223e-04,
       9.59766332e-05, 8.21599366e-05, 7.27857282e-05, 6.21251663e-05,
       5.52193209e-05, 4.69724577e-05, 4.19165849e-05, 3.55213752e-05,
       3.18509245e-05, 2.68838191e-05, 2.42519534e-05, 2.03976270e-05,
       1.85493579e-05, 1.55804256e-05, 1.43358387e-05, 1.21023518e-05,
       1.13492542e-05, 9.77971077e-06, 9.47825579e-06, 8.59696263e-06,
       8.80254768e-06, 8.77354577e-06, 9.69099159e-06, 1.09084929e-05])
gmax80=np.array([1.32486429e-02, 1.60289305e-02, 1.96392508e-02, 2.43178068e-02,
       3.03739337e-02, 3.82094890e-02, 4.83458379e-02, 6.14550679e-02,
       7.83906097e-02, 1.00198531e-01, 1.28062362e-01, 1.63060490e-01,
       2.05478733e-01, 2.53216053e-01, 2.98866850e-01, 3.26226197e-01,
       3.32952869e-01, 3.24503768e-01, 3.06070649e-01, 2.81882632e-01,
       2.55095945e-01, 2.27864188e-01, 2.01588743e-01, 1.77061546e-01,
       1.54710167e-01, 1.34652952e-01, 1.16887054e-01, 1.01261461e-01,
       8.76266449e-02, 7.57567292e-02, 6.54805910e-02, 5.65776171e-02,
       4.89007700e-02, 4.22610576e-02, 3.65463059e-02, 3.16030633e-02,
       2.73514916e-02, 2.36696284e-02, 2.05035989e-02, 1.77569811e-02,
       1.53953567e-02, 1.33422506e-02, 1.15772571e-02, 1.00392545e-02,
       8.71766105e-03, 7.56314624e-03, 6.57186361e-03, 5.70357936e-03,
       4.95895916e-03, 4.30484558e-03, 3.74483898e-03, 3.25134329e-03,
       2.82978548e-03, 2.45698847e-03, 2.13943414e-03, 1.85749577e-03,
       1.61817776e-03, 1.40473669e-03, 1.22433665e-03, 1.06259978e-03,
       9.26607094e-04, 8.03940114e-04, 7.01438664e-04, 6.08321682e-04,
       5.31089352e-04, 4.60340155e-04, 4.02178009e-04, 3.48372394e-04,
       3.04603415e-04, 2.63641339e-04, 2.30734887e-04, 1.99514978e-04,
       1.74804830e-04, 1.50979722e-04, 1.32452011e-04, 1.14244145e-04,
       1.00377664e-04, 8.64404854e-05, 7.60863216e-05, 6.53996368e-05,
       5.76904547e-05, 4.94816146e-05, 4.37633645e-05, 3.74481104e-05,
       3.32288667e-05, 2.83673675e-05, 2.52794953e-05, 2.15445167e-05,
       1.93176729e-05, 1.64731349e-05, 1.49169145e-05, 1.28065660e-05,
       1.18032049e-05, 1.03511592e-05, 9.86107311e-06, 9.08915007e-06,
       9.17607253e-06, 9.24846149e-06, 1.01380797e-05, 1.14539258e-05])
gmax90=np.array([1.16900354e-02, 1.41516212e-02, 1.73566651e-02, 2.15192440e-02,
       2.69180910e-02, 3.39165789e-02, 4.29888049e-02, 5.47513074e-02,
       6.99990105e-02, 8.97330743e-02, 1.15150138e-01, 1.47502339e-01,
       1.87622894e-01, 2.34676308e-01, 2.83516522e-01, 3.20612537e-01,
       3.34540413e-01, 3.30798294e-01, 3.15050090e-01, 2.92069847e-01,
       2.65514717e-01, 2.37900315e-01, 2.10914405e-01, 1.85506134e-01,
       1.62241636e-01, 1.41278828e-01, 1.22682939e-01, 1.06287512e-01,
       9.19837972e-02, 7.95079485e-02, 6.87213784e-02, 5.93579680e-02,
       5.13019276e-02, 4.43177522e-02, 3.83249974e-02, 3.31254330e-02,
       2.86712890e-02, 2.47986501e-02, 2.14853811e-02, 1.85963063e-02,
       1.61277542e-02, 1.39677494e-02, 1.21251389e-02, 1.05064615e-02,
       9.12857503e-03, 7.91280650e-03, 6.88076992e-03, 5.96568986e-03,
       5.19166059e-03, 4.50157438e-03, 3.92045439e-03, 3.39913387e-03,
       2.96253396e-03, 2.56807971e-03, 2.23992632e-03, 1.94102437e-03,
       1.69435483e-03, 1.46754080e-03, 1.28215686e-03, 1.10980802e-03,
       9.70550390e-04, 8.39405432e-04, 7.34879422e-04, 6.34942495e-04,
       5.56572972e-04, 4.80299026e-04, 4.21626949e-04, 3.63314042e-04,
       3.19471176e-04, 2.74805796e-04, 2.42121415e-04, 2.07837447e-04,
       1.83543196e-04, 1.57165603e-04, 1.39173636e-04, 1.18825508e-04,
       1.05561477e-04, 8.98186277e-05, 8.00958484e-05, 6.78772131e-05,
       6.08018397e-05, 5.12869377e-05, 4.61865658e-05, 3.87535971e-05,
       3.51237268e-05, 2.93036452e-05, 2.67679904e-05, 2.22113912e-05,
       2.04933709e-05, 1.69484333e-05, 1.58525173e-05, 1.31538225e-05,
       1.25570251e-05, 1.06272381e-05, 1.04834570e-05, 9.35330866e-06,
       9.71724227e-06, 9.57522919e-06, 1.06598687e-05, 1.19538873e-05])
gmax100=np.array([1.02129578e-02, 1.23707375e-02, 1.51876127e-02, 1.88540340e-02,
       2.36185475e-02, 2.98062843e-02, 3.78435554e-02, 4.82893136e-02,
       6.18739868e-02, 7.95399441e-02, 1.02466106e-01, 1.32018492e-01,
       1.69479688e-01, 2.15198242e-01, 2.66485457e-01, 3.13552265e-01,
       3.35110804e-01, 3.36486702e-01, 3.23729220e-01, 3.02166334e-01,
       2.75959258e-01, 2.48033469e-01, 2.20356638e-01, 1.94082229e-01,
       1.69888388e-01, 1.48019360e-01, 1.28567891e-01, 1.11401400e-01,
       9.64030668e-02, 8.33233826e-02, 7.20030669e-02, 6.21847241e-02,
       5.37288792e-02, 4.64082049e-02, 4.01192358e-02, 3.46727727e-02,
       2.99998703e-02, 2.59465468e-02, 2.24715654e-02, 1.94502376e-02,
       1.68617607e-02, 1.46048120e-02, 1.26728834e-02, 1.09830167e-02,
       9.53829037e-03, 8.27016216e-03, 7.18786261e-03, 6.23423262e-03,
       5.42222308e-03, 4.70374763e-03, 4.09379226e-03, 3.55158013e-03,
       3.09298539e-03, 2.68318514e-03, 2.33817642e-03, 2.02803722e-03,
       1.76838980e-03, 1.53338560e-03, 1.33796049e-03, 1.15968157e-03,
       1.01261529e-03, 8.77215450e-04, 7.66584181e-04, 6.63632104e-04,
       5.80461752e-04, 5.02087739e-04, 4.39617516e-04, 3.79877459e-04,
       3.33010251e-04, 2.87410013e-04, 2.52301001e-04, 2.17439835e-04,
       1.91187894e-04, 1.64490539e-04, 1.44906300e-04, 1.24421380e-04,
       1.09852664e-04, 9.41008079e-05, 8.33011268e-05, 7.11604884e-05,
       6.31899622e-05, 5.38100240e-05, 4.79608144e-05, 4.06977074e-05,
       3.64381450e-05, 3.08066153e-05, 2.77398516e-05, 2.33785371e-05,
       2.12129670e-05, 1.78611047e-05, 1.63912232e-05, 1.38765315e-05,
       1.29746126e-05, 1.12143224e-05, 1.08358599e-05, 9.85640856e-06,
       1.00665507e-05, 1.00536022e-05, 1.10895107e-05, 1.24910925e-05])

# Sensitivity analysis
plt.figure(dpi=1200)
plt.plot(y2['y'][0:params.n,-1],-params.z,label='Baseline',linewidth=0.5,color='red')
plt.plot(gmax10,-params.z,label='10%',linewidth=0.25,color='black')
plt.plot(gmax20,-params.z,label='20%',linewidth=0.35,color='black')
plt.plot(gmax30,-params.z,label='30%',linewidth=0.45,color='black')
plt.plot(gmax40,-params.z,label='40%',linewidth=0.55,color='black')
plt.plot(gmax50,-params.z,label='50%',linewidth=0.65,color='black')
plt.plot(gmax60,-params.z,label='60%',linewidth=0.75,color='black')
plt.plot(gmax70,-params.z,label='70%',linewidth=0.85,color='black')
plt.plot(gmax80,-params.z,label='80%',linewidth=0.95,color='black')
plt.plot(gmax90,-params.z,label='90%',linewidth=1.05,color='black')
plt.plot(gmax100,-params.z,label='100%',linewidth=1.15,color='black')
plt.xlabel('Phytoplankton (mmol N/m3)')
plt.ylabel('Depth [m]')
plt.title('Sensitivity analysis - Increase of g_max')
plt.ylim([-30,0])
plt.legend()
plt.show()


"""
Concentration plots w & w/o surface plot
"""
#Phytoplankton
plt.pcolor(y2['t'],-params.z,y2['y'][0:100,:])
plt.colorbar()
plt.xlabel('Time (days)')
plt.ylabel('Depth (m)')
plt.title('Phytoplankton (mm N/m$^3$)')
plt.show()

#Nutrients
plt.pcolor(y2['t'],-params.z,y2['y'][100:200,:])
plt.colorbar()
plt.xlabel('Time (days)')
plt.ylabel('Depth (m)')
plt.title('Nutrients (mmol N/m$^3$)')
plt.show()


#Light
plt.plot(I,-params.z,color = 'black')
plt.xlabel('Light (Î¼mol photons/m$^2$/s)')
plt.ylabel('Depth (m)')
#plt.title('Light intensity')
plt.show()

#Phytoplankton w/o surface plot
plt.plot(y2['y'][0:100,-1],-params.z,color = 'black')
plt.xlabel('Phytoplankton (mm N/m$^3$)')
plt.ylabel('Depth (m)')
#plt.title('Phytoplankton')
plt.show()

#Nutrients w/o surface plot
plt.plot(y2['y'][100:200,-1],-params.z,color = 'black')
plt.xlabel('Nutrients (mmol N/m$^3$)')
plt.ylabel('Depth (m)')
#plt.title('Nutrients')
plt.show()